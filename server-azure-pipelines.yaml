trigger:
  branches:
    include:
      - main

pool:
  vmImage: "windows-latest"

variables:
  buildConfiguration: "Release"

steps:
  - task: UseDotNet@2
    inputs:
      packageType: "sdk"
      version: "9.0.303"

  - task: DotNetCoreCLI@2
    inputs:
      command: "restore"
      projects: "server/DotNet.csproj"

  - task: DotNetCoreCLI@2
    inputs:
      command: "build"
      projects: "server/DotNet.csproj"
      arguments: "--configuration $(buildConfiguration)"

  - task: DotNetCoreCLI@2
    inputs:
      command: "publish"
      publishWebProjects: true
      arguments: "--configuration $(buildConfiguration) --output $(Build.ArtifactStagingDirectory)"
      zipAfterPublish: true

  - task: PublishBuildArtifacts@1
    inputs:
      pathToPublish: "$(Build.ArtifactStagingDirectory)"
      artifactName: "dotnetapp"
# Release pipeline will deploy this artifact to Azure App Service
